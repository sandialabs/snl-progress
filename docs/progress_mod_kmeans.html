<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Progress K-Means Module &#8212; ProGRESS 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=8d563738"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Progress Matrices Module" href="progress_mod_matrices.html" />
    <link rel="prev" title="Progress Main MPI Module" href="progress_main_MPI.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="progress-k-means-module">
<h1>Progress K-Means Module<a class="headerlink" href="#progress-k-means-module" title="Link to this heading">¶</a></h1>
<section id="mod-kmeans-py">
<h2>mod_kmeans.py<a class="headerlink" href="#mod-kmeans-py" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">mod_kmeans.py</span></code> provides functionality for <strong>k-means clustering</strong> of solar generation
data. It contains the <code class="docutils literal notranslate"><span class="pre">KMeans_Pipeline</span></code> class, which:</p>
<ul class="simple">
<li><p>Preprocesses the solar and clear-sky irradiance data.</p></li>
<li><p>Allows evaluation of different cluster sizes using metrics like SSE and silhouette scores.</p></li>
<li><p>Performs cluster probability calculations to facilitate random day selection in the MCS.</p></li>
</ul>
<section id="kmeans-pipeline-package">
<span id="module-progress.mod_kmeans"></span><h3>KMeans_Pipeline Package<a class="headerlink" href="#kmeans-pipeline-package" title="Link to this heading">¶</a></h3>
<p>This package provides the <cite>KMeans_Pipeline</cite> class to perform KMeans clustering on solar generation data.
The package includes functionality for preprocessing, data transformation, clustering, and evaluation.</p>
<dl class="simple">
<dt>Class:</dt><dd><p>KMeans_Pipeline: A pipeline class for running KMeans clustering on solar generation data.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="progress.mod_kmeans.directory">
<span class="sig-prename descclassname"><span class="pre">progress.mod_kmeans.</span></span><span class="sig-name descname"><span class="pre">directory</span></span><a class="headerlink" href="#progress.mod_kmeans.directory" title="Link to this definition">¶</a></dt>
<dd><p>Path to the directory containing the solar data files.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="progress.mod_kmeans.site_data">
<span class="sig-prename descclassname"><span class="pre">progress.mod_kmeans.</span></span><span class="sig-name descname"><span class="pre">site_data</span></span><a class="headerlink" href="#progress.mod_kmeans.site_data" title="Link to this definition">¶</a></dt>
<dd><p>Path to the CSV file containing site information.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<section id="example-usage">
<h4>Example Usage:<a class="headerlink" href="#example-usage" title="Link to this heading">¶</a></h4>
<p>This example demonstrates how to use the <cite>KMeans_Pipeline</cite> class to perform KMeans clustering on solar generation data.
It performs the following steps:
1. Initializes the pipeline with the <cite>solar_data.xlsx</cite> file and a list of selected sites.
2. Calculates the cluster probabilities using the <cite>calculate_cluster_probability</cite> method.
3. Splits and clusters the data based on the generated labels using the <cite>split_and_cluster_data</cite> method.
4. Outputs metrics of the clustering to a text file using the <cite>test_metrics</cite> method.</p>
<p>Note: Ensure the data file <cite>solar_data.xlsx</cite> exists in the same directory as the script, or provide an absolute path to it.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="c1"># Define the list of selected sites for analysis</span>
    <span class="n">directory</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;/Users/abera/Documents/My_Projects/QuESt_Reliability/QuESt_Reliability_App/Data/Solar&#39;</span>
    <span class="n">site_data</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">+</span> <span class="s1">&#39;/solar_sites.csv&#39;</span>

    <span class="c1"># Initialize the KMeans_Pipeline class</span>
    <span class="n">pipeline</span> <span class="o">=</span> <span class="n">KMeans_Pipeline</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">site_data</span><span class="p">)</span>

    <span class="c1"># Generate and save the clustering metrics to a text file</span>
    <span class="n">pipeline</span><span class="o">.</span><span class="n">test_metrics</span><span class="p">(</span><span class="n">clust_eval</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>

    <span class="c1"># Uncomment the following lines to run additional steps</span>
    <span class="c1"># pipeline.run(n_clusters = 5)</span>
    <span class="c1"># pipeline.calculate_cluster_probability()</span>
    <span class="c1"># pipeline.split_and_cluster_data()</span>
</pre></div>
</div>
</section>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">progress.mod_kmeans.</span></span><span class="sig-name descname"><span class="pre">KMeans_Pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A pipeline class for running KMeans clustering on solar generation data.
It performs preprocessing, data transformation, and finally clusters the data.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.excel_file_path">
<span class="sig-name descname"><span class="pre">excel_file_path</span></span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.excel_file_path" title="Link to this definition">¶</a></dt>
<dd><p>Path to the Excel file containing the Solar Generation, Site Information, and CSI data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.solar_gen_df">
<span class="sig-name descname"><span class="pre">solar_gen_df</span></span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.solar_gen_df" title="Link to this definition">¶</a></dt>
<dd><p>DataFrame containing Solar Generation data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.site_info_df">
<span class="sig-name descname"><span class="pre">site_info_df</span></span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.site_info_df" title="Link to this definition">¶</a></dt>
<dd><p>DataFrame containing Site Information.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.csi_df">
<span class="sig-name descname"><span class="pre">csi_df</span></span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.csi_df" title="Link to this definition">¶</a></dt>
<dd><p>DataFrame containing Clear Sky Index (CSI) data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.selected_sites">
<span class="sig-name descname"><span class="pre">selected_sites</span></span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.selected_sites" title="Link to this definition">¶</a></dt>
<dd><p>List of site names to be included in the analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.first_light">
<span class="sig-name descname"><span class="pre">first_light</span></span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.first_light" title="Link to this definition">¶</a></dt>
<dd><p>DataFrame containing first light timings.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.last_light">
<span class="sig-name descname"><span class="pre">last_light</span></span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.last_light" title="Link to this definition">¶</a></dt>
<dd><p>DataFrame containing last light timings.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.sg_mean_am">
<span class="sig-name descname"><span class="pre">sg_mean_am</span></span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.sg_mean_am" title="Link to this definition">¶</a></dt>
<dd><p>AM Solar generation mean values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.sg_mean_pm">
<span class="sig-name descname"><span class="pre">sg_mean_pm</span></span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.sg_mean_pm" title="Link to this definition">¶</a></dt>
<dd><p>PM Solar generation mean values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.csi_sd_am">
<span class="sig-name descname"><span class="pre">csi_sd_am</span></span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.csi_sd_am" title="Link to this definition">¶</a></dt>
<dd><p>AM Cloud Sky Irradiance standard deviation values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.csi_sd_pm">
<span class="sig-name descname"><span class="pre">csi_sd_pm</span></span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.csi_sd_pm" title="Link to this definition">¶</a></dt>
<dd><p>PM Cloud Sky Irradiance standard deviation values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.kmeans_df">
<span class="sig-name descname"><span class="pre">kmeans_df</span></span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.kmeans_df" title="Link to this definition">¶</a></dt>
<dd><p>DataFrame prepared for KMeans clustering.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.predicted_labels">
<span class="sig-name descname"><span class="pre">predicted_labels</span></span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.predicted_labels" title="Link to this definition">¶</a></dt>
<dd><p>Cluster labels for each data point.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.silhouette">
<span class="sig-name descname"><span class="pre">silhouette</span></span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.silhouette" title="Link to this definition">¶</a></dt>
<dd><p>Silhouette score of the clustering.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.calculate_cluster_probability">
<span class="sig-name descname"><span class="pre">calculate_cluster_probability</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.calculate_cluster_probability" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the monthly probabilities for each cluster label.</p>
<p>This method generates a pivot DataFrame that shows the monthly probabilities for each cluster.
It operates on the class attributes <cite>predicted_labels</cite> and <cite>kmeans_df</cite>.</p>
<p>The function goes through the following steps:
1. Resets the index of <cite>kmeans_df</cite>.
2. Extracts the month from the date column in <cite>kmeans_df</cite>.
3. Groups the data by cluster and month, calculating the count of data points in each group.
4. Calculates the total count for each month.
5. Merges both counts to calculate probabilities.
6. Saves the calculated probabilities in a pivot DataFrame.</p>
<p>The resulting DataFrame is saved to a CSV file named ‘percentage_probability.csv’.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The function saves the output to a CSV file and modifies class attributes.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.create_kmeans_df">
<span class="sig-name descname"><span class="pre">create_kmeans_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sg_mean_am</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sg_mean_pm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csi_sd_am</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csi_sd_pm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_light</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_light</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.create_kmeans_df" title="Link to this definition">¶</a></dt>
<dd><p>Combines various DataFrames to form a DataFrame ready for K-means clustering.</p>
<p>This function performs several operations:
- Sets the index to ‘date’ for all input DataFrames.
- Adds appropriate suffixes to each DataFrame to maintain data context.
- Concatenates all DataFrames along the columns.
- Sorts the resulting DataFrame by the column names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sg_mean_am</strong> (<em>DataFrame</em>) – DataFrame containing mean AM solar generation data.</p></li>
<li><p><strong>sg_mean_pm</strong> (<em>DataFrame</em>) – DataFrame containing mean PM solar generation data.</p></li>
<li><p><strong>csi_sd_am</strong> (<em>DataFrame</em>) – DataFrame containing standard deviation of AM cloud-to-sun irradiance data.</p></li>
<li><p><strong>csi_sd_pm</strong> (<em>DataFrame</em>) – DataFrame containing standard deviation of PM cloud-to-sun irradiance data.</p></li>
<li><p><strong>first_light</strong> (<em>DataFrame</em>) – DataFrame containing the first light hours for each day.</p></li>
<li><p><strong>last_light</strong> (<em>DataFrame</em>) – DataFrame containing the last light hours for each day.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame that combines all input DataFrames, ready for K-means clustering.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.find_elbow">
<span class="sig-name descname"><span class="pre">find_elbow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kmeans_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clust_eval</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.find_elbow" title="Link to this definition">¶</a></dt>
<dd><p>Finds the optimal number of clusters for KMeans clustering using the elbow method.</p>
<p>This method goes through the following steps:
1. Resets the DataFrame index.
2. Converts ‘date’ to ‘month’ and creates cyclical features for it.
3. Scales features and applies PCA via a preprocessing pipeline.
4. Loops through a predefined number of clusters (1 to 11).
5. Performs KMeans clustering with the specified number of clusters.
6. Calculates the sum of squared errors (SSE) for each KMeans run.
7. Uses the KneeLocator to identify the “elbow point” in the SSE curve, which indicates the optimal number of clusters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kmeans_df</strong> (<em>DataFrame</em>) – The DataFrame to cluster.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Contains the following elements:</dt><dd><ul class="simple">
<li><p>The optimal number of clusters, as determined by the elbow method.</p></li>
<li><p>The sum of squared errors (SSE) for each number of clusters from 1 to 11.</p></li>
<li><p>Silhouette scores for each number of clusters from 2 to 11.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.process_csi_data">
<span class="sig-name descname"><span class="pre">process_csi_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">csi_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_sites</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.process_csi_data" title="Link to this definition">¶</a></dt>
<dd><p>Processes cloud-to-sun irradiance data to get standard deviation for AM and PM periods.</p>
<p>This function performs several operations:
- Filters the data for selected sites.
- Scales the data using standardization.
- Calculates the standard deviation for AM and PM slots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>csi_info</strong> (<em>DataFrame</em>) – DataFrame containing the cloud-to-sun irradiance data.
The DataFrame should have a ‘datetime’ column and columns for each site’s irradiance.</p></li>
<li><p><strong>selected_sites</strong> (<em>list</em>) – List of site names to include in the processing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Two DataFrames representing the standard deviation for AM and PM values, respectively.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.process_flh_and_llh">
<span class="sig-name descname"><span class="pre">process_flh_and_llh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solar_gen_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_sites</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.process_flh_and_llh" title="Link to this definition">¶</a></dt>
<dd><p>Processes first and last light hours from solar generation data.</p>
<p>This function performs the following:
- Identifies the first and last light hours for each day based on solar generation data.
- Encodes these hours as cyclic features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solar_gen_df</strong> (<em>DataFrame</em>) – DataFrame containing the solar generation data.
The DataFrame should have a ‘datetime’ column and columns for each site’s solar generation.</p></li>
<li><p><strong>selected_sites</strong> (<em>list</em>) – List of site columns to include from solar_gen_df.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Two DataFrames representing first and last light hours, respectively,</dt><dd><p>with cyclic features encoded.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<dl class="simple">
<dt>Internal Functions:</dt><dd><ul class="simple">
<li><p>get_first_non_zero(series): Returns the first non-zero hour in a time series.</p></li>
<li><p>get_last_non_zero(series): Returns the last non-zero hour in a time series.</p></li>
<li><p>encode_cyclic_features(df): Encodes specified features as cyclic.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.process_solar_data">
<span class="sig-name descname"><span class="pre">process_solar_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solar_gen_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_info_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_sites</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.process_solar_data" title="Link to this definition">¶</a></dt>
<dd><p>Processes solar generation data to obtain mean AM and PM values.</p>
<p>This function performs several operations:
- Filters the data for selected sites.
- Normalizes solar generation data by the wattage limit for each site.
- Calculates the mean solar generation for AM and PM slots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solar_gen_df</strong> (<em>DataFrame</em>) – DataFrame containing the solar generation data.
The DataFrame should have a ‘datetime’ column and columns for each site’s solar generation.</p></li>
<li><p><strong>site_info_df</strong> (<em>DataFrame</em>) – DataFrame containing information about the sites,
including ‘site_name’ and ‘MW’ (megawatt capacity).</p></li>
<li><p><strong>selected_sites</strong> (<em>list</em>) – List of site names to include in the processing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Two DataFrames representing mean AM and mean PM values, respectively.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.run" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.run_kmeans_pipeline">
<span class="sig-name descname"><span class="pre">run_kmeans_pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kmeans_df</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.run_kmeans_pipeline" title="Link to this definition">¶</a></dt>
<dd><p>Executes the K-means clustering pipeline on the input DataFrame.</p>
<p>The function performs the following steps:
1. Resets the DataFrame index.
2. Converts ‘date’ to ‘month’ and creates cyclical features for it.
3. Scales features and applies PCA via a preprocessing pipeline.
4. Executes K-means clustering.
5. Combines preprocessing and clustering into one pipeline.
6. Fits the pipeline to the data.
7. Computes the silhouette score to evaluate clustering quality.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kmeans_df</strong> (<em>DataFrame</em>) – The DataFrame to cluster.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to configure K-means clustering,
such as ‘n_clusters’ to specify the number of clusters (default is 11).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Contains the following elements:</dt><dd><ul class="simple">
<li><p>Clustered DataFrame with a new ‘cluster’ column.</p></li>
<li><p>Predicted cluster labels.</p></li>
<li><p>The fitted pipeline object.</p></li>
<li><p>Silhouette score for the clustering.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.split_and_cluster_data">
<span class="sig-name descname"><span class="pre">split_and_cluster_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.split_and_cluster_data" title="Link to this definition">¶</a></dt>
<dd><p>Splits the solar generation data into clusters and saves each cluster’s data into separate CSV files.</p>
<p>This method first normalizes the solar generation data by site wattage and then transposes the data
into 24-hour segments. Each segment is labeled with a cluster identifier based on previously determined
labels. The data for each cluster is then saved into a dedicated directory and CSV file.</p>
<p>The method organizes the output by creating a directory for each cluster under a main ‘Clusters’ directory,
where each directory contains CSV files for each data column, segmented by day.</p>
<dl class="simple">
<dt>Side Effects:</dt><dd><ul class="simple">
<li><p>Creates a directory structure under ‘Clusters’ in the specified directory.</p></li>
<li><p>Writes multiple CSV files containing the clustered data.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>This method performs file I/O operations and does not return any values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="simple">
<dt>Example Directory Structure:</dt><dd><dl class="simple">
<dt>Clusters/</dt><dd><dl class="simple">
<dt>cluster_1/</dt><dd><p>site1.csv
site2.csv</p>
</dd>
<dt>cluster_2/</dt><dd><p>site1.csv
site2.csv</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.test_metrics">
<span class="sig-name descname"><span class="pre">test_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clust_eval</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.test_metrics" title="Link to this definition">¶</a></dt>
<dd><p>Calculates and writes K-means clustering metrics to a text file.</p>
<p>This method evaluates the clustering performance using the elbow method and silhouette scores,
and writes the detailed results to a file named ‘clustering_results.txt’.</p>
<p>The method outputs a detailed explanation of the elbow method and silhouette scores, and
it identifies the optimal number of clusters based on the provided dataset. It also captures
the sum of squared errors (SSE) for different numbers of clusters, along with their respective
silhouette scores.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>clust_eval</strong> (<em>int</em>) – The maximum number of clusters to evaluate, which determines the range
of clusters to consider for finding the elbow point.</p>
</dd>
</dl>
<dl class="simple">
<dt>Side Effects:</dt><dd><ul class="simple">
<li><p>Writes to a file ‘clustering_results.txt’ in the specified directory.</p></li>
<li><p>Temporarily redirects stdout to this file to capture print statements.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>This method does not return a value but writes output to a file.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="simple">
<dt>Example of File Output:</dt><dd><p>The optimal number of clusters in a dataset is the number that…
Optimal Number of Clusters: X
SSE for Y Clusters: Z
Silhouette Score for Y Clusters: W</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="progress.mod_kmeans.KMeans_Pipeline.update_progress">
<span class="sig-name descname"><span class="pre">update_progress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">process</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#progress.mod_kmeans.KMeans_Pipeline.update_progress" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">ProGRESS</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html"><ins>Pro</ins>babilistic <ins>G</ins>rid <ins>R</ins>eliability Analysis with <ins>E</ins>nergy <ins>S</ins>torage <ins>S</ins>ystems (ProGRESS)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api_reference.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="progress_module.html">Progress Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="progress_data_download_process.html">Progress Data Download Process Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="progress_example_simulation.html">Progress Example Simulation Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="progress_example_simulation_mult_proc.html">Progress Example Simulation (Mult Proc) Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="progress_main_MPI.html">Progress Main MPI Module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Progress K-Means Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="progress_mod_matrices.html">Progress Matrices Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="progress_mod_plot.html">Progress Plot Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="progress_mod_solar.html">Progress Solar Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="progress_mod_sysdata.html">Progress System Data Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="progress_mod_utilities.html">Progress Utilities Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="progress_mod_wind.html">Progress Wind Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="progress_paths.html">Progress Paths Module</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="api_reference.html">API Reference</a><ul>
      <li>Previous: <a href="progress_main_MPI.html" title="previous chapter">Progress Main MPI Module</a></li>
      <li>Next: <a href="progress_mod_matrices.html" title="next chapter">Progress Matrices Module</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Atri Bera.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/progress_mod_kmeans.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>